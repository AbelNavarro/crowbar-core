# Managed by Crowbar.
# Do not edit.
{
  ####################################
  # sysloginfo
  ####################################
  "sysloginfo": [
   {
      "loglevel":"WARN",
      "logservers":[
        {
          "serverip":"<%= @admin_node_ip %>"
          "port_num":514
          "description":"Crowbar admin node"
        }
      ]
    }
  ]

  ####################################
  # vlans
  ####################################
  "vlans": [
    <% @unique_vlans.each do | vlan| %>
    {
      "vlan_name": "vlan<%= vlan %>",
      "vlan_id": <%= vlan %>
    },
    <% end %>
  ]

  ####################################
  # LAGs
  ####################################
  "LAGs": [
  <% @lags.keys.sort.each do |lag_id| %>
    {
      "lag_id": <%= lag_id %>,
      "ports": [
      <% @lags[lag_id]["ports"].each do |port_key| %>
        { "port_id": "<%= port_key %>" },
      <% end %>
      ]
    },
  <% end %>
  ]

  ####################################
  # Interfaces
  ####################################
  "interfaces": [
    <% @interfaces.keys.sort.each do |interface_id| %>
    {
      "id": <%= interface_id %>
      "vlans": [
      <% @interfaces[interface_id].keys.sort.each do |vlan| %>
        { 
          "vlan_name": "vlan<%= vlan %>",
          "vlan_mode": "<%= @interfaces[interface_id][vlan] ? "TAGGED" : "UNTAGGED" %>",
        },
      <% end %>
      ],
    },
    <% end %>
  ]
}
