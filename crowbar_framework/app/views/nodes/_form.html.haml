- form_for :node, :url => update_node_path(@node.handle), "data-remote" => true, :html => { :role => "form", "data-type" => "html", "data-method" => "put" } do |f|
  .panel.panel-default
    .panel-heading
      %h2
        = @node.name

        .btn-group.pull-right
          = link_to t("cancel"), nodes_path(:selected => @node.handle), :class => "btn btn-default"
          %input.btn.btn-default{ :type => "submit", :name => "submit", :value => t(".save") }

          - unless @node.allocated? or @node.admin?
            %input.btn.btn-default{ :type => "submit", :name => "submit", :value => t(".allocate") }

    .panel-body
      - if @node.allocated
        .form-group
          = f.label :target_platform, t('.target_platform')
          %span.form-control{ :disabled => "disabled" }
            = @node.pretty_target_platform

        - if crowbar_service.require_license_key? @node.target_platform
          .form-group
            = f.label :license_key, t('.license_key')
            %span.form-control{ :disabled => "disabled" }
              = @node.license_key
      - else
        .form-group
          = f.label :target_platform, t('.target_platform')
          = select_tag :target_platform, platforms_for_select(@node.target_platform), :class => "form-control", "data-showit" => crowbar_service.require_license_platforms.join(","), "data-showit-target" => "#license_key"

        .form-group
          = f.label :license_key, t('.license_key')
          = text_field_tag :license_key, @node.license_key, :class => "form-control"

      .form-group
        = f.label :alias, t('.alias')
        = text_field_tag :alias, @node.alias(true), :class => "form-control"

      .form-group
        = f.label :public_name, t('.public_name')
        = text_field_tag :public_name, @node.public_name(true), :class => "form-control"

        %span.help-block
          = t('.public_name_hint')

      .form-group
        = f.label :description, t('.description')
        = text_field_tag :description, @node.description(true), :class => "form-control"

      .form-group
        = f.label :group, t('.group')
        - if @node.display_set? 'group'
          = text_field_tag :group, @node.group, :class => "form-control", :placeholder => @node.group
        - else
          = text_field_tag :group, @node.group(true), :class => "form-control", :placeholder => @node.group

      .form-group
        = f.label :intended_role, t('.intended_role')
        = select_tag :intended_role, options_for_select([[t('.no_role'),'no_role'], [t('.controller'), 'controller'], [t('.compute'), 'compute'], [t('.network'), 'network'], [t('.storage'), 'storage']], @node.intended_role), :class => "form-control"

      - if crowbar_options[:show].include? :bios
        .form-group
          = f.label :bios, t('.bios')
          - if @node.admin?
            %span.form-control
              = t('na')
          - else
            = select_tag :bios, options_for_select(crowbar_options[:bios], @node.bios_set), :class => "form-control"

      - if crowbar_options[:show].include? :raid
        .form-group
          = f.label :raid, t('.raid')
          - if @node.admin?
            %span.form-control
              = t('na')
          - else
            = select_tag :raid, options_for_select(crowbar_options[:raid], @node.raid_set), :class => "form-control"

    .panel-footer.text-right
      .btn-group
        = link_to t("cancel"), nodes_path(:selected => @node.handle), :class => "btn btn-default"
        %input.btn.btn-default{ :type => "submit", :name => "submit", :value => t(".save") }

        - unless @node.allocated? or @node.admin?
          %input.btn.btn-default{ :type => "submit", :name => "submit", :value => t(".allocate") }
